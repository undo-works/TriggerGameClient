# 攻撃と撃破時の動きの実装

今回実装した主な機能：

## 1. 戦闘エフェクト表示システム

### ダメージ表示
- **機能**: 攻撃を受けたキャラクターの上にダメージ数値を表示
- **表示**: 赤い文字で`-{ダメージ値}`を表示
- **アニメーション**: 上に移動しながら1.5秒でフェードアウト

### 回避表示
- **機能**: 攻撃が回避された場合に「MISS」を表示
- **表示**: 緑い文字で「MISS」を表示
- **アニメーション**: 上に移動しながら1.5秒でフェードアウト

### ベイルアウト表示
- **機能**: 撃破されたキャラクターに「ベイルアウト」表示
- **表示**: 黒背景に白文字で「ベイルアウト」を表示
- **アニメーション**: 2秒間で上に移動しながらフェードアウト

## 2. 撃破時のキャラクター削除

### フェードアウト処理
- **タイミング**: ベイルアウト表示から0.5秒後に開始
- **効果**: 1秒間でキャラクターを透明にしてから削除

### 完全削除処理
- HPバーの削除
- 各種マップからの削除（位置、ID、方向、行動力など）
- プレイヤー/敵キャラクター配列からの削除
- トリガー表示のクリア
- キャラクターオブジェクトの削除

## 3. 戦闘結果処理の改善

### `processCombatResult`メソッドの強化
- ダメージ/回避の適切な表示制御
- 撃破時の自動ベイルアウト処理
- 視覚的フィードバックの向上

## 実装したメソッド

1. **`showDamageText(character, damage)`**: ダメージ表示
2. **`showAvoidText(character)`**: 回避表示
3. **`showBailOutAndRemoveCharacter(character)`**: ベイルアウト表示と削除
4. **`removeCharacterCompletely(character)`**: キャラクター完全削除

## 技術詳細

- **Phaserのツイーンシステム**を使用したアニメーション
- **デプス管理**（z-index: 10）で最前面表示
- **非同期アニメーション**による自然な演出
- **メモリリーク防止**のための適切なオブジェクト削除

## 推奨コミットメッセージ

```
feat: 戦闘エフェクトと撃破時のベイルアウト機能を実装

- 攻撃時にダメージ数値をキャラクター上に表示
- 回避時に「MISS」を表示
- 撃破時に「ベイルアウト」表示とキャラクター削除
- アニメーション付きの視覚的フィードバックを追加
- キャラクター完全削除時のメモリ管理を実装

Changes:
- processCombatResultメソッドにエフェクト表示を追加
- showDamageText, showAvoidText, showBailOutAndRemoveCharacterメソッドを実装
- Phaserツイーンを使用したアニメーション効果
- 撃破キャラクターの適切なクリーンアップ処理
```

または、より簡潔に：

```
feat: 戦闘エフェクトとベイルアウト機能実装

攻撃時のダメージ表示、回避時のMISS表示、撃破時のベイルアウト表示と
キャラクター削除機能を追加。アニメーション付きで視覚的フィードバックを向上。
```
