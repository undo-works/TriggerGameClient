# 1st対応したい要件集

## ゲームグリッドを全画面に広げたい

### 課題

- ゲームグリッドが小さい
  * 現状：ゲームグリッドが画面の一部にしか表示されていない
  * 理想：ゲームグリッドが画面全体に表示されている

## スパゲティコードをリファクタリングしたい

### 課題

- コードがスパゲティ化している
  * 現状：コードがGameGrid.tsxに集中しており、可読性が低い
  * 理想：処理のフローはGameGridで追えるようにし、以下のように分割する  
    ゲーム画面の見た目の管理 -> GameView.ts  
    戦闘ロジック管理 -> CombatSystem.ts 
    グリッドフィールドで必要な計算など -> HexUtils.ts  
    キャラクター状態管理 -> CharacterManager.ts  

## キャラクターの移動を簡略化したい

### 課題

- キャラクターの移動が面倒
  * 現状：キャラクターのクリック -> 移動先(1マス)の選択 -> 移動 -> メイントリガーの向き設定 -> サブトリガーの向き設定

### 解決案

1. 追尾移動機能の作成
    - 自身のキャラクターをクリック -> 敵キャラクターをクリック -> 確認ダイアログで「追尾移動」を選択
      以降対象キャラクターを目指して自動で追尾移動する
    - 対象が撃墜済みの場合は、最も近い敵キャラクターを自動で追尾する
    - 自動追尾中のトリガーは自動追尾の対象の方向を指定する

2. 複数マス移動機能の作成
    - 自身のキャラクターをクリック -> 残りの行動力で移動できるマスから移動先を選択 -> 移動先で選択したトリガーの向きをすべてのマスで利用

    ### 小課題

    - 移動しなかったときに、行動力が減っていない
      -> 移動しなかった場合の分岐内で行動力を一つ減らす処理を追加した

    - 一マスごとに行動履歴を保存する
      -> 移動処理のループ内で一マスごとに行動履歴を保存するようにした
      -> hexUtils.findPath関数を改善し、移動経路をピクセル計算によって求めた

## 2ターン目以降の操作ができなくなるバグ修正

**-> ターン番号入力処理を改善済み**

## 撃墜されたキャラクターが表示されないが存在し続けるバグ修正

-> 多分解決した

## UIをゲームっぽくしたい

-> もうちょっと機能面を拡充させてからのほうがよさそう
-> **まずは防御・回避・ベイルアウトなどの表示が分かりやすくするところから**

### 防御

- シールドを表示する
 - HPの量に応じて青->黄->赤にグラデーション
 - 撃墜されたときは非表示
 - シールドは対象キャラクターの直上に表示する

